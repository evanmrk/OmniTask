<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane style="-fx-background-color: #f4f4f4;"
            xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.omnitask.controller.LeaveRequestController">

    <!-- HEADER MERAH MARUN -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: #5c1a1b;">
            <padding><Insets bottom="15" left="20" right="20" top="15" /></padding>
            <Label text="Form Pengajuan Izin &amp; Cuti" textFill="WHITE">
                <font><Font name="System Bold" size="22" /></font>
            </Label>
        </HBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" style="-fx-background-color: transparent;">
            <VBox spacing="20" maxWidth="600" alignment="TOP_CENTER">
                <padding><Insets top="30" right="30" bottom="30" left="30"/></padding>

                <!-- PILIHAN TIPE -->
                <VBox spacing="5" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 0);">
                    <Label text="Pilih Jenis Pengajuan:" style="-fx-font-weight: bold;"/>
                    <ComboBox fx:id="cbLeaveType" promptText="-- Silakan Pilih --" prefWidth="300"/>
                </VBox>

                <!-- INFO USER (OTOMATIS) -->
                <VBox spacing="10" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 0);">
                    <Label text="Data Pemohon" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                    <Separator/>
                    <GridPane hgap="10" vgap="10">
                        <Label text="Nama Lengkap:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <TextField fx:id="txtName" disable="true" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                        <Label text="ID Karyawan:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="txtId" disable="true" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                    </GridPane>
                </VBox>

                <!-- FORM A: KHUSUS CUTI / IZIN BIASA -->
                <VBox fx:id="formGeneral" spacing="10" visible="false" managed="false"
                      style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 0);">
                    <Label text="Detail Izin / Cuti" style="-fx-font-weight: bold; -fx-text-fill: #2980b9;"/>
                    <Separator/>

                    <!-- DIGANTI JADI HBOX (Tanggal Mulai & Selesai) -->
                    <HBox spacing="10">
                        <VBox>
                            <Label text="Tanggal Mulai:"/>
                            <DatePicker fx:id="dpStartDateGeneral"/>
                        </VBox>
                        <VBox>
                            <Label text="Tanggal Selesai:"/>
                            <DatePicker fx:id="dpEndDateGeneral"/> <!-- ID BARU -->
                        </VBox>
                    </HBox>

<!--                    <Label text="Durasi (hari):"/>-->
<!--                    <TextField fx:id="txtDuration" promptText="Contoh: 2 Hari"/>-->

                    <Label text="Alasan Izin:"/>
                    <TextArea fx:id="txtReason" prefRowCount="3" promptText="Jelaskan alasan izin Anda..."/>
                </VBox>

                <!-- FORM B: KHUSUS PERJALANAN DINAS -->
                <VBox fx:id="formDinas" spacing="10" visible="false" managed="false"
                      style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 0);">
                    <Label text="Detail Perjalanan Dinas" style="-fx-font-weight: bold; -fx-text-fill: #e67e22;"/>
                    <Separator/>

                    <Label text="Kota/Lokasi Tujuan:"/>
                    <TextField fx:id="txtDestination" promptText="Contoh: Jakarta Pusat"/>

                    <Label text="Keperluan Dinas:"/>
                    <TextArea fx:id="txtPurpose" prefRowCount="3" promptText="Jelaskan tujuan dinas..."/>

                    <HBox spacing="10">
                        <VBox>
                            <Label text="Tanggal Berangkat:"/>
                            <DatePicker fx:id="dpStartDateDinas"/>
                        </VBox>
                        <VBox>
                            <Label text="Tanggal Kembali:"/>
                            <DatePicker fx:id="dpEndDateDinas"/>
                        </VBox>
                    </HBox>

                    <Label text="Transportasi:"/>
                    <TextField fx:id="txtTransport" promptText="Contoh: Pesawat / Kereta / Mobil Kantor"/>
                </VBox>

                <Button text="AJUKAN PERMOHONAN" onAction="#handleSubmit"
                        style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 20; -fx-font-size: 14px;"/>


                <VBox spacing="10" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 0);">
                    <HBox alignment="CENTER_LEFT">
                        <Label text="Riwayat Pengajuan Saya" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="ðŸ”„ Refresh" onAction="#handleRefresh" style="-fx-font-size: 11px;"/>
                    </HBox>
                    <Separator/>

                    <TableView fx:id="tableMyRequests" prefHeight="250">
                        <columns>
                            <TableColumn fx:id="colReqId" text="ID Request" prefWidth="100"/>
                            <TableColumn fx:id="colDate" text="Tanggal Mulai" prefWidth="120"/>
                            <TableColumn fx:id="colType" text="Tipe" prefWidth="100"/>
                            <TableColumn fx:id="colStatus" text="Status" prefWidth="120"/>
                            <TableColumn fx:id="colReason" text="Alasan / Keterangan" prefWidth="200"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                        <placeholder>
                            <Label text="Belum ada riwayat pengajuan izin."/>
                        </placeholder>
                    </TableView>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>

    <!-- NAVIGASI BAWAH -->
    <bottom>
        <HBox alignment="CENTER" spacing="15" style="-fx-background-color: #ddd;">
            <padding><Insets bottom="10" left="20" right="20" top="10" /></padding>
            <Button text="ðŸ  Attendance" onAction="#handleBackToDashboard"/>
            <Button text="ðŸ“‹ Tasks" onAction="#handleGoToTasks"/>


<!--            <Button text="ðŸ—‘ Hapus" onAction="#handleDelete"-->
<!--                    style="-fx-background-color: #7f8c8d; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand;"/>-->

            <Button text="ðŸ“ Leave Request" style="-fx-background-color: #5c1a1b; -fx-text-fill: white; -fx-font-weight: bold;"/>
            <Button fx:id="btnEmployees" text="ðŸ‘¥ Employees"
                    onAction="#handleGoToEmployees"
                    visible="false" managed="false"
                    style="-fx-background-color: #333; -fx-text-fill: gold; -fx-font-weight: bold;"/>
        </HBox>
    </bottom>

</BorderPane>